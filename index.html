<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Card Bazaar 1.3 FIXED</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f4f4;
      color: #333;
    }
    .container {
      display: flex;
      flex-direction: column;
    }
    .header {
      background-color: #ffffff;
      padding: 40px 20px;
      display: flex;
      align-items: center;
      border-bottom: 2px solid #e0e0e0;
      box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.1);
    }
    .logo {
      font-family: 'Bangers', Impact, Charcoal, sans-serif;
      font-size: 120px;
      color: #d92626;
      letter-spacing: 2px;
      text-shadow: 3px 3px #000000;
      flex: 1;
    }
    .content {
      display: flex;
    }
    .right-sidebar {
      width: 180px;
      padding-left: 20px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .right-sidebar a {
      color: #444;
      text-decoration: none;
      font-size: 20px;
      font-weight: 600;
      cursor: pointer;
    }
    .right-sidebar .sidebar-section {
      margin-bottom: 24px;
    }
    .sidebar-content {
      font-size: 14px;
      margin-top: 8px;
      display: none;
    }
    #cartItems {
      list-style: none;
      padding-left: 0;
    }
    #cartItems li {
      margin-bottom: 8px;
    }
    #cartItems button {
      margin-left: 8px;
    }
    #checkoutBtn {
      margin-top: 8px;
    }
    .auth {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }
    #loginForm {
      display: none;
      margin-top: 8px;
    }
    #loginForm input {
      margin-bottom: 4px;
    }
    .condition-buttons {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      background: rgba(0, 0, 0, 0.3);
      padding: 12px 0;
      box-sizing: border-box;
    }
    /* Email capture modal */
    .cb-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .cb-modal {
      background: #fff;
      width: 90%;
      max-width: 420px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
      padding: 20px;
    }
    .cb-modal h3 {
      margin: 0 0 10px;
      font-size: 22px;
    }
    .cb-modal p {
      margin: 0 0 16px;
      font-size: 14px;
      color: #555;
    }
    .cb-modal-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }
    .cb-input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 16px;
      box-sizing: border-box;
    }
    .cb-btn-primary {
      background: linear-gradient(45deg, #d92626, #ff7e5f);
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
    }
    .cb-btn-secondary {
      background: #f3f3f3;
      color: #333;
      border: 1px solid #ddd;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    #loginBtn {
      background: linear-gradient(45deg, #d92626, #ff7e5f);
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    #loginBtn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(2, 512px);
      gap: 40px;
      padding: 20px 40px 60px 40px;
      justify-content: start;
      background-color: #ffffff;
      width: 100%;
    }
    .card {
      position: relative;
      width: 512px;
      height: 716px;
      overflow: visible;
      margin-bottom: 20px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 24px;
    }
    .card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
    }
    .card-stack {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.3s ease-in-out;
      perspective: 1000px;
    }
    .variant-image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      transition: transform 0.3s ease-in-out;
      object-fit: cover;
      cursor: pointer;
      z-index: 1;
      backface-visibility: hidden;
      border-radius: 24px;
    }
    .variant-image.active {
      z-index: 5;
      pointer-events: none;
    }
    .card:hover .card-stack {
      transform: translateY(-5px) rotate(-1deg);
    }
    .variant-image.flipping {
      transform: rotateY(90deg);
    }
    .variant-image[data-condition="VG"],
    .variant-image[data-condition="EX"],
    .variant-image[data-condition="G"] {
      filter: brightness(0.85) contrast(0.95);
    }
    .condition-buttons button,
    .add-cart-btn {
      background: rgba(255, 255, 255, 0.2);
      color: #fff;
      border: 1px solid #fff;
      border-radius: 4px;
      padding: 8px 12px;
      cursor: pointer;
      font-weight: bold;
      font-size: 18px;
    }
    .condition-buttons button:hover,
    .add-cart-btn:hover {
      background: rgba(255, 255, 255, 0.4);
    }

    @media (max-width: 1200px) {
      .grid {
        grid-template-columns: minmax(0, 1fr);
        gap: 20px;
        padding: 16px;
        justify-content: stretch;
        width: 100%;
      }
      .card {
        width: 100%;
        max-width: 512px;
        height: auto;
        aspect-ratio: 512 / 716;
        margin: 0 auto 20px;
      }
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: center;
        padding: 20px 10px;
      }
      .logo {
        font-size: 60px;
        margin-bottom: 10px;
        text-align: center;
      }
      .content {
        flex-direction: column;
        align-items: center;
      }
      .right-sidebar {
        width: 100%;
        padding-left: 0;
        align-items: center;
        margin-top: 20px;
      }
      .grid {
        padding: 12px;
        width: 100%;
      }
      /* Fallback aspect ratio for iOS Safari and older browsers */
      .card {
        position: relative;
        width: 100%;
        max-width: 512px;
        margin: 0 auto 20px;
      }
      .card::before {
        content: '';
        display: block;
        padding-top: calc(716 / 512 * 100%);
      }
      .card-stack {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
      }
      .condition-buttons button,
      .add-cart-btn {
        font-size: 16px;
        padding: 8px 10px;
      }
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">CARD BAZAAR</div>
      <div class="auth">
        <span id="userStatus"></span>
        <button id="loginBtn">Log In/Create My Account</button>
        <div id="loginForm">
          <input type="email" id="loginEmail" placeholder="Email">
          <input type="password" id="loginPassword" placeholder="Password">
          <button id="loginSubmit" type="button">Submit</button>
        </div>
      </div>
    </div>
    <div class="content">
      <div class="grid" id="cardGrid">
        <!-- Cards will be populated here -->
      </div>
      <div class="right-sidebar">
        <div class="sidebar-section">
          <a id="cartToggle">ðŸ›’ My Cart</a>
          <div id="cartMenu" class="sidebar-content">
            <ul id="cartItems"></ul>
            <div id="cartTotal"></div>
            <button id="checkoutBtn" style="display:none;">Proceed to Checkout</button>
          </div>
        </div>
        <div class="sidebar-section">
          <a id="binderToggle">ðŸ“˜ My Binder</a>
          <div id="binderInfo" class="sidebar-content">
            Welcome to My Binder. Here, you will find cards you have purchased, as well as cards have added from your own personal inventory. Helps to keep track of what you currently have in your binder.
          </div>
        </div>
        <div class="sidebar-section">
          <a id="sellToggle">ðŸ’° Sell Cards</a>
          <div id="sellInfo" class="sidebar-content">
            Looking to sell us your cards? Our team of Graders will verify the condition of each card and give you the highest market rate out of any other retailer for your NM editions. Coming soon!
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Email Capture Modal (injected content target) -->
  <div id="cbEmailOverlay" class="cb-modal-overlay" aria-hidden="true">
    <div class="cb-modal" role="dialog" aria-labelledby="cbEmailTitle" aria-modal="true">
      <h3 id="cbEmailTitle">Join the Card Bazaar waitlist</h3>
      <p>Be first to know about card drops, promos, and features.</p>
      <input type="email" id="cbEmailInput" class="cb-input" placeholder="Enter your email" aria-label="Email address">
      <div class="cb-modal-actions">
        <button id="cbEmailSubmit" class="cb-btn-primary">Join Waitlist</button>
        <button id="cbEmailDismiss" class="cb-btn-secondary">No thanks</button>
      </div>
      <div id="cbEmailMessage" style="margin-top:8px;font-size:14px;color:#2e7d32;display:none;"></div>
    </div>
  </div>
    <script src="fetchCardImages.js"></script>
    <script src="app.js"></script>
    <script>
      fetchCardImages();
    </script>
</body>
</html>
